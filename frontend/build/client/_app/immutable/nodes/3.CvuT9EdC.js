import{f as d,a as c,c as J}from"../chunks/CPI-Sj6W.js";import{p as $t,z as v,A as Bt,u as Pt,s as i,B as O,C as a,a as Ut,D as Yt,$ as Dt,E as o,F as r,g as t,G as K,H as Rt,I as M,J as qt}from"../chunks/DZJbeXPm.js";import{s as N}from"../chunks/DRMUDMiI.js";import{i as E}from"../chunks/LXw8YH9d.js";import{e as ot,i as it,s as Ft}from"../chunks/DksMkqyi.js";import{h as Ot,r as W,b as Z}from"../chunks/D8iSYxBw.js";import{d as Qt,e as Vt}from"../chunks/D1vpSegM.js";import{p as Xt,b as jt}from"../chunks/BK0TuHnG.js";import{s as zt,a as Gt}from"../chunks/CWTv1oOY.js";import{a as nt}from"../chunks/DOQewpRz.js";var Ht=d('<div class="alert alert-error"> </div>'),Jt=d("<p>Loading accounts...</p>"),Kt=d('<span class="badge badge-system svelte-11yx1mx">System</span>'),Mt=d('<span class="badge badge-inactive svelte-11yx1mx">Inactive</span>'),Wt=d('<tr><td class="code svelte-11yx1mx"> </td><td> </td><td class="description svelte-11yx1mx"> </td><td><!></td></tr>'),Zt=d('<section class="account-section card svelte-11yx1mx"><h2 class="svelte-11yx1mx"> </h2> <table class="table"><thead><tr><th>Code</th><th>Name</th><th>Description</th><th>Status</th></tr></thead><tbody></tbody></table></section>'),te=d('<div class="modal-backdrop svelte-11yx1mx" role="presentation"><div class="modal card svelte-11yx1mx" role="dialog" aria-modal="true" aria-labelledby="create-account-title" tabindex="-1"><h2 id="create-account-title" class="svelte-11yx1mx">Create Account</h2> <form><div class="form-group"><label class="label" for="code">Account Code</label> <input class="input" type="text" id="code" required placeholder="1100"/></div> <div class="form-group"><label class="label" for="name">Account Name</label> <input class="input" type="text" id="name" required placeholder="Cash and Bank"/></div> <div class="form-group"><label class="label" for="type">Account Type</label> <select class="input" id="type"><option>Asset</option><option>Liability</option><option>Equity</option><option>Revenue</option><option>Expense</option></select></div> <div class="form-group"><label class="label" for="description">Description</label> <input class="input" type="text" id="description" placeholder="Optional description"/></div> <div class="modal-actions svelte-11yx1mx"><button type="button" class="btn btn-secondary">Cancel</button> <button type="submit" class="btn btn-primary">Create</button></div></form></div></div>'),ee=d('<div class="container"><div class="header svelte-11yx1mx"><h1 class="svelte-11yx1mx">Chart of Accounts</h1> <button class="btn btn-primary">+ New Account</button></div> <!> <!></div> <!>',1);function pe(lt,ct){$t(ct,!0);const tt=()=>zt(Xt,"$page",vt),[vt,dt]=Gt();let k=v(Bt([])),Q=v(!0),A=v(""),I=v(!1),w=v(""),$=v(""),B=v("ASSET"),P=v("");Pt(()=>{const e=tt().url.searchParams.get("tenant");e&&pt(e)});async function pt(e){i(Q,!0),i(A,"");try{i(k,await nt.listAccounts(e),!0)}catch(s){i(A,s instanceof Error?s.message:"Failed to load accounts",!0)}finally{i(Q,!1)}}async function ut(e){e.preventDefault();const s=tt().url.searchParams.get("tenant");if(s)try{const n=await nt.createAccount(s,{code:t(w),name:t($),account_type:t(B),description:t(P)||void 0});i(k,[...t(k),n].sort((p,u)=>p.code.localeCompare(u.code)),!0),i(I,!1),i(w,""),i($,""),i(B,"ASSET"),i(P,"")}catch(n){i(A,n instanceof Error?n.message:"Failed to create account",!0)}}function _t(e){const s={ASSET:[],LIABILITY:[],EQUITY:[],REVENUE:[],EXPENSE:[]};for(const n of e)s[n.account_type].push(n);return s}const mt={ASSET:"Assets",LIABILITY:"Liabilities",EQUITY:"Equity",REVENUE:"Revenue",EXPENSE:"Expenses"};var et=ee();Ot("11yx1mx",e=>{Yt(()=>{Dt.title="Chart of Accounts - Open Accounting"})});var V=O(et),X=o(V),ft=a(o(X),2);ft.__click=()=>i(I,!0),r(X);var at=a(X,2);{var bt=e=>{var s=Ht(),n=o(s,!0);r(s),K(()=>N(n,t(A))),c(e,s)};E(at,e=>{t(A)&&e(bt)})}var yt=a(at,2);{var xt=e=>{var s=Jt();c(e,s)},ht=e=>{const s=M(()=>_t(t(k)));var n=J(),p=O(n);ot(p,17,()=>Object.entries(mt),it,(u,U)=>{var f=M(()=>qt(t(U),2));let Y=()=>t(f)[0],S=()=>t(f)[1];const b=M(()=>t(s)[Y()]);var y=J(),T=O(y);{var C=_=>{var x=Zt(),m=o(x),D=o(m,!0);r(m);var L=a(m,2),R=a(o(L));ot(R,21,()=>t(b),it,(l,h)=>{var q=Wt();let st;var j=o(q),At=o(j,!0);r(j);var z=a(j),It=o(z,!0);r(z);var G=a(z),St=o(G,!0);r(G);var rt=a(G),Tt=o(rt);{var Ct=g=>{var F=Kt();c(g,F)},Lt=g=>{var F=J(),Nt=O(F);{var kt=H=>{var wt=Mt();c(H,wt)};E(Nt,H=>{t(h).is_active||H(kt)},!0)}c(g,F)};E(Tt,g=>{t(h).is_system?g(Ct):g(Lt,!1)})}r(rt),r(q),K(()=>{st=Ft(q,1,"svelte-11yx1mx",null,st,{inactive:!t(h).is_active}),N(At,t(h).code),N(It,t(h).name),N(St,t(h).description||"-")}),c(l,q)}),r(R),r(L),r(x),K(()=>N(D,S())),c(_,x)};E(T,_=>{t(b).length>0&&_(C)})}c(u,y)}),c(e,n)};E(yt,e=>{t(Q)?e(xt):e(ht,!1)})}r(V);var gt=a(V,2);{var Et=e=>{var s=te();s.__click=()=>i(I,!1);var n=o(s);n.__click=l=>l.stopPropagation();var p=a(o(n),2),u=o(p),U=a(o(u),2);W(U),r(u);var f=a(u,2),Y=a(o(f),2);W(Y),r(f);var S=a(f,2),b=a(o(S),2),y=o(b);y.value=y.__value="ASSET";var T=a(y);T.value=T.__value="LIABILITY";var C=a(T);C.value=C.__value="EQUITY";var _=a(C);_.value=_.__value="REVENUE";var x=a(_);x.value=x.__value="EXPENSE",r(b),r(S);var m=a(S,2),D=a(o(m),2);W(D),r(m);var L=a(m,2),R=o(L);R.__click=()=>i(I,!1),Rt(2),r(L),r(p),r(n),r(s),Vt("submit",p,ut),Z(U,()=>t(w),l=>i(w,l)),Z(Y,()=>t($),l=>i($,l)),jt(b,()=>t(B),l=>i(B,l)),Z(D,()=>t(P),l=>i(P,l)),c(e,s)};E(gt,e=>{t(I)&&e(Et)})}c(lt,et),Ut(),dt()}Qt(["click"]);export{pe as component};
