import{f as p,a as c,c as ca}from"../chunks/CPI-Sj6W.js";import{o as ua}from"../chunks/BdGAytfj.js";import{p as ga,z as h,A as _a,B as W,s as i,C as n,a as pa,D as fa,E as r,g as a,$ as ma,F as e,G as S,H as K}from"../chunks/DZJbeXPm.js";import{s as y}from"../chunks/DRMUDMiI.js";import{i as L}from"../chunks/LXw8YH9d.js";import{e as ba,s as xa,i as ha}from"../chunks/DksMkqyi.js";import{h as ya,r as Q,b as V,s as B}from"../chunks/D8iSYxBw.js";import{d as ja,e as za}from"../chunks/D1vpSegM.js";import{a as X}from"../chunks/DOQewpRz.js";var Ca=p('<div class="alert alert-error"> </div>'),ka=p("<p>Loading...</p>"),wa=p('<div class="card empty-state svelte-x1i5gj"><h2 class="svelte-x1i5gj">Welcome to Open Accounting!</h2> <p class="svelte-x1i5gj">Create your first organization to get started.</p> <button class="btn btn-primary">Create Organization</button></div>'),Oa=p('<li><button class="tenant-item svelte-x1i5gj"><span class="tenant-name svelte-x1i5gj"> </span> <span class="tenant-role badge svelte-x1i5gj"> </span></button></li>'),Ta=p('<div class="card org-details svelte-x1i5gj"><h3 class="svelte-x1i5gj"> </h3> <dl class="details-grid svelte-x1i5gj"><dt class="svelte-x1i5gj">Currency</dt> <dd> </dd> <dt class="svelte-x1i5gj">Country</dt> <dd> </dd> <dt class="svelte-x1i5gj">Timezone</dt> <dd> </dd></dl> <div class="quick-links svelte-x1i5gj"><a class="btn btn-secondary">Chart of Accounts</a> <a class="btn btn-secondary">Journal Entries</a> <a class="btn btn-secondary">Reports</a></div></div>'),Aa=p('<div class="grid svelte-x1i5gj"><div class="card"><h3>Organizations</h3> <ul class="tenant-list svelte-x1i5gj"></ul></div> <!></div>'),Da=p('<div class="modal-backdrop svelte-x1i5gj" role="presentation"><div class="modal card svelte-x1i5gj" role="dialog" aria-modal="true" aria-labelledby="create-org-title" tabindex="-1"><h2 id="create-org-title" class="svelte-x1i5gj">Create Organization</h2> <form><div class="form-group"><label class="label" for="name">Organization Name</label> <input class="input" type="text" id="name" required placeholder="My Company"/></div> <div class="form-group"><label class="label" for="slug">URL Identifier</label> <input class="input" type="text" id="slug" required pattern="[a-z0-9][a-z0-9-]*[a-z0-9]" placeholder="my-company"/> <small class="svelte-x1i5gj">Only lowercase letters, numbers, and hyphens</small></div> <div class="modal-actions svelte-x1i5gj"><button type="button" class="btn btn-secondary">Cancel</button> <button type="submit" class="btn btn-primary">Create</button></div></form></div></div>'),Ea=p('<div class="container"><div class="header svelte-x1i5gj"><h1 class="svelte-x1i5gj">Dashboard</h1> <button class="btn btn-primary">+ New Organization</button></div> <!> <!></div> <!>',1);function Ga(Y,Z){ga(Z,!0);let v=h(_a([])),l=h(null),G=h(!0),C=h(""),j=h(!1),k=h(""),w=h("");ua(async()=>{var s;try{i(v,await X.getMyTenants(),!0),a(v).length>0&&i(l,((s=a(v).find(t=>t.is_default))==null?void 0:s.tenant)||a(v)[0].tenant,!0)}catch(t){i(C,t instanceof Error?t.message:"Failed to load tenants",!0)}finally{i(G,!1)}});async function aa(s){s.preventDefault(),i(C,"");try{const t=await X.createTenant(a(k),a(w));i(v,[...a(v),{tenant:t,role:"owner",is_default:a(v).length===0}],!0),i(l,t,!0),i(j,!1),i(k,""),i(w,"")}catch(t){i(C,t instanceof Error?t.message:"Failed to create organization",!0)}}function ta(){i(w,a(k).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,""),!0)}var H=Ea();ya("x1i5gj",s=>{fa(()=>{ma.title="Dashboard - Open Accounting"})});var q=W(H),F=r(q),ea=n(r(F),2);ea.__click=()=>i(j,!0),e(F);var I=n(F,2);{var ra=s=>{var t=Ca(),f=r(t,!0);e(t),S(()=>y(f,a(C))),c(s,t)};L(I,s=>{a(C)&&s(ra)})}var sa=n(I,2);{var na=s=>{var t=ka();c(s,t)},ia=s=>{var t=ca(),f=W(t);{var O=d=>{var o=wa(),u=n(r(o),4);u.__click=()=>i(j,!0),e(o),c(d,o)},T=d=>{var o=Aa(),u=r(o),A=n(r(u),2);ba(A,21,()=>a(v),ha,(D,g)=>{var _=Oa();let $;var b=r(_);b.__click=()=>i(l,a(g).tenant,!0);var x=r(b),N=r(x,!0);e(x);var z=n(x,2),R=r(z,!0);e(z),e(b),e(_),S(()=>{var E;$=xa(_,1,"svelte-x1i5gj",null,$,{selected:((E=a(l))==null?void 0:E.id)===a(g).tenant.id}),y(N,a(g).tenant.name),y(R,a(g).role)}),c(D,_)}),e(A),e(u);var M=n(u,2);{var m=D=>{var g=Ta(),_=r(g),$=r(_,!0);e(_);var b=n(_,2),x=n(r(b),2),N=r(x,!0);e(x);var z=n(x,4),R=r(z,!0);e(z);var E=n(z,4),da=r(E,!0);e(E),e(b);var J=n(b,2),P=r(J),U=n(P,2),va=n(U,2);e(J),e(g),S(()=>{y($,a(l).name),y(N,a(l).settings.default_currency),y(R,a(l).settings.country_code),y(da,a(l).settings.timezone),B(P,"href",`/accounts?tenant=${a(l).id??""}`),B(U,"href",`/journal?tenant=${a(l).id??""}`),B(va,"href",`/reports?tenant=${a(l).id??""}`)}),c(D,g)};L(M,D=>{a(l)&&D(m)})}e(o),c(d,o)};L(f,d=>{a(v).length===0?d(O):d(T,!1)},!0)}c(s,t)};L(sa,s=>{a(G)?s(na):s(ia,!1)})}e(q);var la=n(q,2);{var oa=s=>{var t=Da();t.__click=()=>i(j,!1);var f=r(t);f.__click=m=>m.stopPropagation();var O=n(r(f),2),T=r(O),d=n(r(T),2);Q(d),d.__input=ta,e(T);var o=n(T,2),u=n(r(o),2);Q(u),K(2),e(o);var A=n(o,2),M=r(A);M.__click=()=>i(j,!1),K(2),e(A),e(O),e(f),e(t),za("submit",O,aa),V(d,()=>a(k),m=>i(k,m)),V(u,()=>a(w),m=>i(w,m)),c(s,t)};L(la,s=>{a(j)&&s(oa)})}c(Y,H),pa()}ja(["click","input"]);export{Ga as component};
