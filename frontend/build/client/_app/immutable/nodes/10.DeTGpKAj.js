import{f as v,a as n,c as oe,t as gt}from"../chunks/CPI-Sj6W.js";import{o as le}from"../chunks/BdGAytfj.js";import{p as ne,z as k,A as ie,a as ce,D as pe,C as s,E as a,g as t,I as A,s as f,$ as ve,F as e,B as J,G as b,J as de}from"../chunks/DZJbeXPm.js";import{s as i}from"../chunks/DRMUDMiI.js";import{i as g}from"../chunks/LXw8YH9d.js";import{e as ht,i as kt,s as _e}from"../chunks/DksMkqyi.js";import{h as me,r as ue,b as fe}from"../chunks/D8iSYxBw.js";import{d as be}from"../chunks/D1vpSegM.js";import{p as ge,b as he}from"../chunks/BK0TuHnG.js";import{a as ke,s as xe}from"../chunks/CWTv1oOY.js";import{a as ye}from"../chunks/DOQewpRz.js";var Te=v('<button class="btn btn-secondary svelte-2pp8mk">Print</button>'),Ee=v('<div class="card empty-state svelte-2pp8mk"><p>Please select a tenant from the <a href="/dashboard">dashboard</a>.</p></div>'),Ae=v('<div class="alert alert-error"> </div>'),Ie=v('<p class="empty-message svelte-2pp8mk">No account balances found for this date.</p>'),Be=v('<tr><td class="account-code svelte-2pp8mk"> </td><td class="svelte-2pp8mk"> </td><td class="amount svelte-2pp8mk"> </td><td class="amount svelte-2pp8mk"> </td></tr>'),Se=v('<tr class="section-header svelte-2pp8mk"><td colspan="4" class="svelte-2pp8mk"> </td></tr> <!>',1),$e=v('<table class="report-table svelte-2pp8mk"><thead><tr><th class="svelte-2pp8mk">Account Code</th><th class="svelte-2pp8mk">Account Name</th><th class="amount svelte-2pp8mk">Debit</th><th class="amount svelte-2pp8mk">Credit</th></tr></thead><tbody></tbody><tfoot class="svelte-2pp8mk"><tr class="totals svelte-2pp8mk"><td colspan="2" class="svelte-2pp8mk"><strong>Totals</strong></td><td class="amount svelte-2pp8mk"><strong> </strong></td><td class="amount svelte-2pp8mk"><strong> </strong></td></tr><tr class="balance-status svelte-2pp8mk"><td colspan="4"><!></td></tr></tfoot></table>'),De=v('<div class="report card svelte-2pp8mk"><div class="report-header svelte-2pp8mk"><h2 class="svelte-2pp8mk">Trial Balance</h2> <p class="report-date svelte-2pp8mk"> </p></div> <!> <p class="report-footer svelte-2pp8mk"> </p></div>'),Le=v('<div class="report-controls card svelte-2pp8mk"><div class="control-row svelte-2pp8mk"><div class="form-group svelte-2pp8mk"><label class="label" for="reportType">Report Type</label> <select class="input" id="reportType"><option>Trial Balance</option><option disabled>Balance Sheet (coming soon)</option><option disabled>Income Statement (coming soon)</option></select></div> <div class="form-group svelte-2pp8mk"><label class="label" for="asOfDate">As of Date</label> <input class="input" type="date" id="asOfDate"/></div> <button class="btn btn-primary"> </button></div></div> <!> <!>',1),Re=v('<div class="container"><div class="header svelte-2pp8mk"><h1 class="svelte-2pp8mk">Financial Reports</h1> <!></div> <!></div>');function Xe(xt,yt){ne(yt,!0);const Tt=()=>xe(ge,"$page",Et),[Et,At]=ke();let I=A(()=>Tt().url.searchParams.get("tenant")||""),x=k(!1),y=k(""),B=k(ie(new Date().toISOString().split("T")[0])),l=k(null),M=k("trial-balance");le(()=>{t(I)&&H()});async function H(){f(x,!0),f(y,"");try{f(l,await ye.getTrialBalance(t(I),t(B)),!0)}catch(r){f(y,r instanceof Error?r.message:"Failed to load trial balance",!0)}finally{f(x,!1)}}function K(r){return!r||r.isZero()?"-":r.toFixed(2)}function It(r){const o=r.net_balance;return o.isZero()?{debit:"-",credit:"-"}:o.greaterThan(0)?{debit:o.toFixed(2),credit:"-"}:{debit:"-",credit:o.abs().toFixed(2)}}function Bt(r){const o={ASSET:[],LIABILITY:[],EQUITY:[],REVENUE:[],EXPENSE:[]};for(const m of r)o[m.account_type]&&o[m.account_type].push(m);return o}function St(r){return{ASSET:"Assets",LIABILITY:"Liabilities",EQUITY:"Equity",REVENUE:"Revenue",EXPENSE:"Expenses"}[r]||r}function $t(){window.print()}var S=Re();me("2pp8mk",r=>{pe(()=>{ve.title="Reports - Open Accounting"})});var $=a(S),Dt=s(a($),2);{var Lt=r=>{var o=Te();o.__click=$t,n(r,o)};g(Dt,r=>{t(l)&&r(Lt)})}e($);var Rt=s($,2);{var Ft=r=>{var o=Ee();n(r,o)},Nt=r=>{var o=Le(),m=J(o),W=a(m),D=a(W),L=s(a(D),2),R=a(L);R.value=R.__value="trial-balance";var F=s(R);F.value=F.__value="balance-sheet";var tt=s(F);tt.value=tt.__value="income-statement",e(L),e(D);var N=s(D,2),et=s(a(N),2);ue(et),e(N);var T=s(N,2);T.__click=H;var Ot=a(T,!0);e(T),e(W),e(m);var at=s(m,2);{var wt=c=>{var u=Ae(),h=a(u,!0);e(u),b(()=>i(h,t(y))),n(c,u)};g(at,c=>{t(y)&&c(wt)})}var Pt=s(at,2);{var Ut=c=>{var u=De(),h=a(u),rt=s(a(h),2),Yt=a(rt);e(rt),e(h);var st=s(h,2);{var Ct=d=>{var O=Ie();n(d,O)},Gt=d=>{const O=A(()=>Bt(t(l).accounts));var w=$e(),P=s(a(w));ht(P,21,()=>Object.entries(t(O)),kt,(p,_)=>{var E=A(()=>de(t(_),2));let zt=()=>t(E)[0],dt=()=>t(E)[1];var _t=oe(),Jt=J(_t);{var Mt=G=>{var mt=Se(),Q=J(mt),ut=a(Q),Ht=a(ut,!0);e(ut),e(Q);var Kt=s(Q,2);ht(Kt,17,dt,kt,(V,X)=>{const ft=A(()=>{const{debit:re,credit:se}=It(t(X));return{debit:re,credit:se}});var Z=Be(),j=a(Z),Wt=a(j,!0);e(j);var q=s(j),te=a(q,!0);e(q);var z=s(q),ee=a(z,!0);e(z);var bt=s(z),ae=a(bt,!0);e(bt),e(Z),b(()=>{i(Wt,t(X).account_code),i(te,t(X).account_name),i(ee,t(ft).debit),i(ae,t(ft).credit)}),n(V,Z)}),b(V=>i(Ht,V),[()=>St(zt())]),n(G,mt)};g(Jt,G=>{dt().length>0&&G(Mt)})}n(p,_t)}),e(P);var lt=s(P),U=a(lt),Y=s(a(U)),nt=a(Y),Vt=a(nt,!0);e(nt),e(Y);var it=s(Y),ct=a(it),Xt=a(ct,!0);e(ct),e(it),e(U);var pt=s(U),C=a(pt);let vt;var Zt=a(C);{var jt=p=>{var _=gt("Trial balance is in balance");n(p,_)},qt=p=>{var _=gt();b(E=>i(_,`Trial balance is NOT in balance!
										Difference: ${E??""}`),[()=>t(l).total_debits.minus(t(l).total_credits).toFixed(2)]),n(p,_)};g(Zt,p=>{t(l).is_balanced?p(jt):p(qt,!1)})}e(C),e(pt),e(lt),e(w),b((p,_)=>{i(Vt,p),i(Xt,_),vt=_e(C,1,"svelte-2pp8mk",null,vt,{balanced:t(l).is_balanced,unbalanced:!t(l).is_balanced})},[()=>K(t(l).total_debits),()=>K(t(l).total_credits)]),n(d,w)};g(st,d=>{t(l).accounts.length===0?d(Ct):d(Gt,!1)})}var ot=s(st,2),Qt=a(ot);e(ot),e(u),b(d=>{i(Yt,`As of ${t(l).as_of_date??""}`),i(Qt,`Generated on ${d??""}`)},[()=>new Date(t(l).generated_at).toLocaleString()]),n(c,u)};g(Pt,c=>{t(l)&&c(Ut)})}b(()=>{T.disabled=t(x),i(Ot,t(x)?"Loading...":"Generate Report")}),he(L,()=>t(M),c=>f(M,c)),fe(et,()=>t(B),c=>f(B,c)),n(r,o)};g(Rt,r=>{t(I)?r(Nt,!1):r(Ft)})}e(S),n(xt,S),ce(),At()}be(["click"]);export{Xe as component};
