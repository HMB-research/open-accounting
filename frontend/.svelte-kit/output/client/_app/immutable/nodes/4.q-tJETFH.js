import{f as E,a as m,c as Je}from"../chunks/CPI-Sj6W.js";import{p as Ke,z as n,A as We,u as Xe,s as r,g as t,B as Se,C as e,E as s,a as Ye,D as Ze,$ as et,F as a,G as ke,H as tt}from"../chunks/DZJbeXPm.js";import{s as C}from"../chunks/DRMUDMiI.js";import{i as Z}from"../chunks/LXw8YH9d.js";import{e as at,s as Le,i as st}from"../chunks/DksMkqyi.js";import{h as rt,b as p,r as u}from"../chunks/D8iSYxBw.js";import{d as lt,e as ot}from"../chunks/D1vpSegM.js";import{b as be,p as it}from"../chunks/BK0TuHnG.js";import{s as nt,a as vt}from"../chunks/CWTv1oOY.js";import{a as Oe}from"../chunks/DOQewpRz.js";var dt=E('<div class="alert alert-error"> </div>'),ct=E("<p>Loading contacts...</p>"),pt=E('<div class="empty-state card svelte-67057e"><p>No contacts found. Create your first contact to get started.</p></div>'),ut=E('<tr><td class="name svelte-67057e"> </td><td><span> </span></td><td class="email svelte-67057e"> </td><td> </td><td class="vat svelte-67057e"> </td><td> </td></tr>'),_t=E('<div class="card"><table class="table"><thead><tr><th>Name</th><th>Type</th><th>Email</th><th>Phone</th><th>VAT Number</th><th>Payment Terms</th></tr></thead><tbody></tbody></table></div>'),mt=E('<div class="modal-backdrop svelte-67057e" role="presentation"><div class="modal card svelte-67057e" role="dialog" aria-modal="true" aria-labelledby="create-contact-title" tabindex="-1"><h2 id="create-contact-title" class="svelte-67057e">Create Contact</h2> <form><div class="form-row svelte-67057e"><div class="form-group svelte-67057e"><label class="label" for="name">Name *</label> <input class="input" type="text" id="name" required placeholder="Company or Person Name"/></div> <div class="form-group svelte-67057e"><label class="label" for="type">Type</label> <select class="input" id="type"><option>Customer</option><option>Supplier</option><option>Both</option></select></div></div> <div class="form-row svelte-67057e"><div class="form-group svelte-67057e"><label class="label" for="email">Email</label> <input class="input" type="email" id="email" placeholder="email@example.com"/></div> <div class="form-group svelte-67057e"><label class="label" for="phone">Phone</label> <input class="input" type="tel" id="phone" placeholder="+372 5551234"/></div></div> <div class="form-group"><label class="label" for="vat">VAT Number</label> <input class="input" type="text" id="vat" placeholder="EE123456789"/></div> <div class="form-group"><label class="label" for="address">Address</label> <input class="input" type="text" id="address" placeholder="Street Address"/></div> <div class="form-row svelte-67057e"><div class="form-group svelte-67057e"><label class="label" for="city">City</label> <input class="input" type="text" id="city" placeholder="Tallinn"/></div> <div class="form-group svelte-67057e"><label class="label" for="postal">Postal Code</label> <input class="input" type="text" id="postal" placeholder="10111"/></div> <div class="form-group svelte-67057e"><label class="label" for="country">Country</label> <select class="input" id="country"><option>Estonia</option><option>Latvia</option><option>Lithuania</option><option>Finland</option><option>Germany</option></select></div></div> <div class="form-group"><label class="label" for="payment-days">Payment Terms (days)</label> <input class="input" type="number" id="payment-days" min="0" max="365"/></div> <div class="modal-actions svelte-67057e"><button type="button" class="btn btn-secondary">Cancel</button> <button type="submit" class="btn btn-primary">Create</button></div></form></div></div>'),ft=E('<div class="container"><div class="header svelte-67057e"><h1 class="svelte-67057e">Contacts</h1> <button class="btn btn-primary">+ New Contact</button></div> <div class="filters card svelte-67057e"><div class="filter-row svelte-67057e"><select class="input"><option>All Types</option><option>Customers</option><option>Suppliers</option><option>Both</option></select> <input class="input search-input svelte-67057e" type="text" placeholder="Search contacts..."/> <button class="btn btn-secondary">Search</button></div></div> <!> <!></div> <!>',1);function St(Re,Ue){Ke(Ue,!0);const ee=()=>nt(it,"$page",Be),[Be,Ne]=vt();let O=n(We([])),te=n(!0),R=n(""),U=n(!1),ae=n(""),se=n(""),M=n(""),H=n("CUSTOMER"),D=n(""),V=n(""),G=n(""),q=n(""),z=n(""),Q=n(""),j=n("EE"),J=n(14);Xe(()=>{const l=ee().url.searchParams.get("tenant");l&&ye(l)});async function ye(l){r(te,!0),r(R,"");try{r(O,await Oe.listContacts(l,{type:t(ae)||void 0,search:t(se)||void 0,active_only:!0}),!0)}catch(i){r(R,i instanceof Error?i.message:"Failed to load contacts",!0)}finally{r(te,!1)}}async function Ae(l){l.preventDefault();const i=ee().url.searchParams.get("tenant");if(i)try{const v=await Oe.createContact(i,{name:t(M),contact_type:t(H),email:t(D)||void 0,phone:t(V)||void 0,vat_number:t(G)||void 0,address_line1:t(q)||void 0,city:t(z)||void 0,postal_code:t(Q)||void 0,country_code:t(j),payment_terms_days:t(J)});r(O,[...t(O),v].sort((f,b)=>f.name.localeCompare(b.name)),!0),r(U,!1),Ie()}catch(v){r(R,v instanceof Error?v.message:"Failed to create contact",!0)}}function Ie(){r(M,""),r(H,"CUSTOMER"),r(D,""),r(V,""),r(G,""),r(q,""),r(z,""),r(Q,""),r(j,"EE"),r(J,14)}async function re(){const l=ee().url.searchParams.get("tenant");l&&ye(l)}const $e={CUSTOMER:"Customer",SUPPLIER:"Supplier",BOTH:"Both"},Fe={CUSTOMER:"badge-customer",SUPPLIER:"badge-supplier",BOTH:"badge-both"};var he=ft();rt("67057e",l=>{Ze(()=>{et.title="Contacts - Open Accounting"})});var le=Se(he),oe=s(le),Me=e(s(oe),2);Me.__click=()=>r(U,!0),a(oe);var ie=e(oe,2),ge=s(ie),B=s(ge);B.__change=re;var ne=s(B);ne.value=ne.__value="";var ve=e(ne);ve.value=ve.__value="CUSTOMER";var de=e(ve);de.value=de.__value="SUPPLIER";var Ce=e(de);Ce.value=Ce.__value="BOTH",a(B);var K=e(B,2);u(K),K.__keyup=l=>l.key==="Enter"&&re();var He=e(K,2);He.__click=re,a(ge),a(ie);var Ee=e(ie,2);{var De=l=>{var i=dt(),v=s(i,!0);a(i),ke(()=>C(v,t(R))),m(l,i)};Z(Ee,l=>{t(R)&&l(De)})}var Ve=e(Ee,2);{var Ge=l=>{var i=ct();m(l,i)},qe=l=>{var i=Je(),v=Se(i);{var f=c=>{var _=pt();m(c,_)},b=c=>{var _=_t(),N=s(_),x=e(s(N));at(x,21,()=>t(O),st,(A,d)=>{var y=ut();let P;var h=s(y),W=s(h,!0);a(h);var T=e(h),w=s(T),I=s(w,!0);a(w),a(T);var S=e(T),$=s(S,!0);a(S);var k=e(S),F=s(k,!0);a(k);var g=e(k),X=s(g,!0);a(g);var L=e(g),Y=s(L);a(L),a(y),ke(()=>{P=Le(y,1,"svelte-67057e",null,P,{inactive:!t(d).is_active}),C(W,t(d).name),Le(w,1,`badge ${Fe[t(d).contact_type]??""}`,"svelte-67057e"),C(I,$e[t(d).contact_type]),C($,t(d).email||"-"),C(F,t(d).phone||"-"),C(X,t(d).vat_number||"-"),C(Y,`${t(d).payment_terms_days??""} days`)}),m(A,y)}),a(x),a(N),a(_),m(c,_)};Z(v,c=>{t(O).length===0?c(f):c(b,!1)},!0)}m(l,i)};Z(Ve,l=>{t(te)?l(Ge):l(qe,!1)})}a(le);var ze=e(le,2);{var Qe=l=>{var i=mt();i.__click=()=>r(U,!1);var v=s(i);v.__click=o=>o.stopPropagation();var f=e(s(v),2),b=s(f),c=s(b),_=e(s(c),2);u(_),a(c);var N=e(c,2),x=e(s(N),2),A=s(x);A.value=A.__value="CUSTOMER";var d=e(A);d.value=d.__value="SUPPLIER";var y=e(d);y.value=y.__value="BOTH",a(x),a(N),a(b);var P=e(b,2),h=s(P),W=e(s(h),2);u(W),a(h);var T=e(h,2),w=e(s(T),2);u(w),a(T),a(P);var I=e(P,2),S=e(s(I),2);u(S),a(I);var $=e(I,2),k=e(s($),2);u(k),a($);var F=e($,2),g=s(F),X=e(s(g),2);u(X),a(g);var L=e(g,2),Y=e(s(L),2);u(Y),a(L);var xe=e(L,2),ce=e(s(xe),2),pe=s(ce);pe.value=pe.__value="EE";var ue=e(pe);ue.value=ue.__value="LV";var _e=e(ue);_e.value=_e.__value="LT";var me=e(_e);me.value=me.__value="FI";var Pe=e(me);Pe.value=Pe.__value="DE",a(ce),a(xe),a(F);var fe=e(F,2),Te=e(s(fe),2);u(Te),a(fe);var we=e(fe,2),je=s(we);je.__click=()=>r(U,!1),tt(2),a(we),a(f),a(v),a(i),ot("submit",f,Ae),p(_,()=>t(M),o=>r(M,o)),be(x,()=>t(H),o=>r(H,o)),p(W,()=>t(D),o=>r(D,o)),p(w,()=>t(V),o=>r(V,o)),p(S,()=>t(G),o=>r(G,o)),p(k,()=>t(q),o=>r(q,o)),p(X,()=>t(z),o=>r(z,o)),p(Y,()=>t(Q),o=>r(Q,o)),be(ce,()=>t(j),o=>r(j,o)),p(Te,()=>t(J),o=>r(J,o)),m(l,i)};Z(ze,l=>{t(U)&&l(Qe)})}be(B,()=>t(ae),l=>r(ae,l)),p(K,()=>t(se),l=>r(se,l)),m(Re,he),Ye(),Ne()}lt(["click","change","keyup"]);export{St as component};
